BEGIN HEADER
   CharacterSet "CP1252"
   ExportingTool "IBM InfoSphere DataStage Export"
   ToolVersion "8"
   ServerName "TEST"
   ToolInstanceID "DataMgmt_Dev"
   MDISVersion "1.0"
   Date "2025-07-03"
   Time "10.50.06"
   ServerVersion "11.7"
END HEADER
BEGIN DSJOB
   Identifier "DDA_PRESENTMENT"
   DateModified "2025-07-03"
   TimeModified "10.46.46"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "Test"
      Readonly "0"
      Name "DDA_PRESENTMENT"
      NextID "214"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "BUSINESS_DATE"
         Prompt "BUSINESS_DATE"
         HelpTxt "YYYY-MM-DD"
         ParamType "0"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Test_Param"
         Prompt "TEST_Param parameters"
         Default "(As pre-defined)"
         HelpTxt "Parameter set for all the Environment Variables used in the project"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "Transformer_2|DDA_TAWEEL|DDA_TAMWEEL_AUDIT|DDA_Takaful|Funnel_16|DDS_FILE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\DDS"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V0S2|V70S0|V211S0|V212S0|V0S16|V213S0"
      StageXPos "504|72|744|72|288|816"
      StageYPos "360|240|312|456|384|504"
      StageTypes "CTransformerStage|CCustomStage.CC_GUI|CCustomStage.CC_GUI|CCustomStage.CC_GUI|CCustomStage|CCustomStage"
      NextStageID "19"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48|48|48|48|48"
      StageYSize "48|48|48|48|48|48"
      ContainerViewSizing "0078 0078 0792 0485 0000 0001 0000 0200"
      StageNames "Transformer_2|DDA_TAWEEL|DDA_TAMWEEL_AUDIT|DDA_Takaful|Funnel_16|DDS_FILE"
      StageTypeIDs "CTransformerStage|OracleConnectorPX|OracleConnectorPX|OracleConnectorPX|PxFunnel|PxSequentialFile"
      LinkNames "FILE_BKP,FILE|DSLink3_taweel| |DSLink3_takaful|DSLink3| "
      LinkHasMetaDatas "True,True|True| |True|True| "
      LinkTypes "1,1|1| |1|1| "
      LinkNamePositionXs "642,684|150| |165|386| "
      LinkNamePositionYs "356,447|343| |467|401| "
      TargetStageIDs "V211S0,V213S0|V0S16| |V0S16|V0S2| "
      SourceStageEffectiveExecutionModes "2,2|2| |2|2| "
      SourceStageRuntimeExecutionModes "2,2|2| |2|2| "
      TargetStageEffectiveExecutionModes "2,1|2| |2|2| "
      TargetStageRuntimeExecutionModes "2,1|2| |2|2| "
      LinkIsSingleOperatorLookup "False,False|False| |False|False| "
      LinkIsSortSequential "False,False|False| |False|False| "
      LinkSortMode "0,0|0| |0|0| "
      LinkPartColMode "1,1|1| |1|1| "
      LinkSourcePinIDs "V0S2P2,V0S2P9|V70S0P2| |V212S0P1|V0S16P5| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S16"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Funnel_16"
      NextID "6"
      InputPins "V0S16P1|V0S16P4"
      OutputPins "V0S16P5"
      StageType "PxFunnel"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "operator"
         Value "funnel"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S16P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink3_taweel"
      Partner "V70S0|V70S0P2"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S16P4"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink3_takaful"
      Partner "V212S0|V212S0P1"
      LinkType "1"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S16P5"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink3"
      Partner "V0S2|V0S2P5"
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "INSTRUCTION_CODE"
         SqlType "1"
         Precision "4"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "INSTRUCTION_CODE"
         Group "0"
         ParsedDerivation "INSTRUCTION_CODE"
         SourceColumn "DSLink3_taweel.INSTRUCTION_CODE;DSLink3_takaful.INSTRUCTION_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OIC_CODE"
         SqlType "12"
         Precision "25"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "OIC_CODE"
         Group "0"
         ParsedDerivation "OIC_CODE"
         SourceColumn "DSLink3_taweel.OIC_CODE;DSLink3_takaful.OIC_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DDA_REFERENCE"
         SqlType "12"
         Precision "23"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DDA_REFERENCE"
         Group "0"
         ParsedDerivation "DDA_REFERENCE"
         SourceColumn "DSLink3_taweel.DDA_REFERENCE;DSLink3_takaful.DDA_REFERENCE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CCY_CODE"
         SqlType "12"
         Precision "3"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "CCY_CODE"
         Group "0"
         ParsedDerivation "CCY_CODE"
         SourceColumn "DSLink3_taweel.CCY_CODE;DSLink3_takaful.CCY_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CLAIMED_AMOUNT"
         SqlType "3"
         Precision "28"
         Scale "2"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "CLAIMED_AMOUNT"
         Group "0"
         ParsedDerivation "CLAIMED_AMOUNT"
         SourceColumn "DSLink3_taweel.CLAIMED_AMOUNT;DSLink3_takaful.CLAIMED_AMOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ORIGINATION_ACCOUNT"
         SqlType "12"
         Precision "60"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "ORIGINATION_ACCOUNT"
         Group "0"
         ParsedDerivation "ORIGINATION_ACCOUNT"
         SourceColumn "DSLink3_taweel.ORIGINATION_ACCOUNT;DSLink3_takaful.ORIGINATION_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYING_BANK"
         SqlType "12"
         Precision "15"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "PAYING_BANK"
         Group "0"
         ParsedDerivation "PAYING_BANK"
         SourceColumn "DSLink3_taweel.PAYING_BANK;DSLink3_takaful.PAYING_BANK"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYER_ACCOUNT"
         SqlType "12"
         Precision "50"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "PAYER_ACCOUNT"
         Group "0"
         ParsedDerivation "PAYER_ACCOUNT"
         SourceColumn "DSLink3_taweel.PAYER_ACCOUNT;DSLink3_takaful.PAYER_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "APPLICATIONID"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "APPLICATIONID"
         Group "0"
         ParsedDerivation "APPLICATIONID"
         SourceColumn "DSLink3_taweel.APPLICATIONID;DSLink3_takaful.APPLICATIONID"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DUMMY"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DUMMY"
         Group "0"
         ParsedDerivation "DUMMY"
         SourceColumn "DSLink3_taweel.DUMMY;DSLink3_takaful.DUMMY"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "386"
      TopTextPos "401"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2"
      OLEType "CTransformerStage"
      Readonly "0"
      Name "Transformer_2"
      NextID "10"
      InputPins "V0S2P5"
      OutputPins "V0S2P2|V0S2P9"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TrxGenCode"
         Value =+=+=+=
//
// Generated file to implement the V0S2_DDA_PRESENTMENT_Transformer_2 transform operator.
//

// define our input/output link names
inputname 0 DSLink3;
outputname 0 FILE_BKP;
outputname 1 FILE;

global {
 // Job parameter declaration
 ustring[] BUSINESS_DATE;
}

initialize {
 // define our control variables
 int8 RowRejected0;
 int8 NullSetVar0;

 // declare our intermediate variables for this section (1)
 string InterVar0_0;
 string InterVar0_1;
 string InterVar0_2;

 // initialise constant values which require conversion
 InterVar0_0 = "fix_zero,suppress_zero";
 InterVar0_1 = ".";
 InterVar0_2 = "00";
 // Stage variable declaration and initialisation
 string StageVar0_VarAmount;
 StageVar0_VarAmount = "";
}

mainloop {

 // evaluate the stage variables first
 StageVar0_VarAmount = string_from_decimal(DSLink3.CLAIMED_AMOUNT , InterVar0_0);

 // initialise the rejected row variable
 RowRejected0 = 1;

 // evaluate columns (no constraints) for link: FILE_BKP
 FILE_BKP.CLAIMED_AMOUNT = ((substring_by_delimiter(StageVar0_VarAmount , InterVar0_1 , 1) + InterVar0_1) + left_substring((substring_by_delimiter(StageVar0_VarAmount , InterVar0_1 , 2) + InterVar0_2) , 2));
 FILE_BKP.LOAD_DT = current_date();
 FILE_BKP.BUSINESS_DATE = BUSINESS_DATE;
 writerecord 0;
 RowRejected0 = 0;
 // evaluate columns (no constraints) for link: FILE
 FILE.CLAIMED_AMOUNT = ((substring_by_delimiter(StageVar0_VarAmount , InterVar0_1 , 1) + InterVar0_1) + left_substring((substring_by_delimiter(StageVar0_VarAmount , InterVar0_1 , 2) + InterVar0_2) , 2));
 writerecord 1;
 RowRejected0 = 0;
}

finish {
}

=+=+=+=
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TrxGenCache"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TrxClassName"
         Value "V0S2_DDA_PRESENTMENT_Transformer_2"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "JobParameterNames"
         Value "BUSINESS_DATE"
      END DSSUBRECORD
      ValidationStatus "0"
      StageType "CTransformerStage"
      BlockSize "0"
      SKKeySourceType "file"
      StageVars "CStageVar"
      BEGIN DSSUBRECORD
         Name "VarAmount"
         Expression "DecimalToString(DSLink3.CLAIMED_AMOUNT,\"fix_zero,suppress_zero\")"
         SqlType "12"
         ParsedExpression "DecimalToString(DSLink3.CLAIMED_AMOUNT, \"fix_zero,suppress_zero\")"
         SourceColumn "DSLink3.CLAIMED_AMOUNT"
         Precision "28"
         ColScale "0"
         ExtendedPrecision "0"
      END DSSUBRECORD
      StageVarsMinimised "0"
      LoopVarsMaximised "0"
      MaxLoopIterations "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P2"
      OLEType "CTrxOutput"
      Readonly "0"
      Name "FILE_BKP"
      Partner "V211S0|V211S0P2"
      Reject "0"
      ErrorPin "0"
      RowLimit "0"
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "INSTRUCTION_CODE"
         SqlType "1"
         Precision "4"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.INSTRUCTION_CODE"
         Group "0"
         ParsedDerivation "DSLink3.INSTRUCTION_CODE"
         SourceColumn "DSLink3.INSTRUCTION_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OIC_CODE"
         SqlType "12"
         Precision "25"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.OIC_CODE"
         Group "0"
         ParsedDerivation "DSLink3.OIC_CODE"
         SourceColumn "DSLink3.OIC_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DDA_REFERENCE"
         SqlType "12"
         Precision "23"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.DDA_REFERENCE"
         Group "0"
         ParsedDerivation "DSLink3.DDA_REFERENCE"
         SourceColumn "DSLink3.DDA_REFERENCE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CCY_CODE"
         SqlType "12"
         Precision "3"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.CCY_CODE"
         Group "0"
         ParsedDerivation "DSLink3.CCY_CODE"
         SourceColumn "DSLink3.CCY_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CLAIMED_AMOUNT"
         SqlType "12"
         Precision "28"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "Field(VarAmount,'.',1) :'.':Left(Field(VarAmount,'.',2) :'00',2)"
         Group "0"
         ParsedDerivation "Field(VarAmount, '.', 1) : '.' : Left(Field(VarAmount, '.', 2) : '00', 2)"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         StageVars "VarAmount"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ORIGINATION_ACCOUNT"
         SqlType "12"
         Precision "60"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.ORIGINATION_ACCOUNT"
         Group "0"
         ParsedDerivation "DSLink3.ORIGINATION_ACCOUNT"
         SourceColumn "DSLink3.ORIGINATION_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYING_BANK"
         SqlType "12"
         Precision "15"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.PAYING_BANK"
         Group "0"
         ParsedDerivation "DSLink3.PAYING_BANK"
         SourceColumn "DSLink3.PAYING_BANK"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYER_ACCOUNT"
         SqlType "12"
         Precision "50"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.PAYER_ACCOUNT"
         Group "0"
         ParsedDerivation "DSLink3.PAYER_ACCOUNT"
         SourceColumn "DSLink3.PAYER_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "APPLICATIONID"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.APPLICATIONID"
         Group "0"
         ParsedDerivation "DSLink3.APPLICATIONID"
         SourceColumn "DSLink3.APPLICATIONID"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DUMMY"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.DUMMY"
         Group "0"
         ParsedDerivation "DSLink3.DUMMY"
         SourceColumn "DSLink3.DUMMY"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "LOAD_DT"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "CurrentDate()"
         Group "0"
         ParsedDerivation "CurrentDate()"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "BUSINESS_DATE"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "BUSINESS_DATE"
         Group "0"
         ParsedDerivation "BUSINESS_DATE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "Schema"
         Value =+=+=+=
record
(
  INSTRUCTION_CODE:nullable string[4];
  OIC_CODE:nullable string[max=25];
  DDA_REFERENCE:nullable string[max=23];
  CCY_CODE:nullable string[max=3];
  CLAIMED_AMOUNT:nullable string[max=28];
  ORIGINATION_ACCOUNT:nullable string[max=60];
  PAYING_BANK:nullable string[max=15];
  PAYER_ACCOUNT:nullable string[max=50];
  APPLICATIONID:nullable string[max=30];
  DUMMY:nullable string[];
  LOAD_DT:nullable date;
  BUSINESS_DATE:string[];
)
=+=+=+=
      END DSSUBRECORD
      LeftTextPos "642"
      TopTextPos "356"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P5"
      OLEType "CTrxInput"
      Readonly "0"
      Name "DSLink3"
      Partner "V0S16|V0S16P5"
      LinkType "1"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "Schema"
         Value =+=+=+=
record
(
  INSTRUCTION_CODE:nullable string[4];
  OIC_CODE:nullable string[max=25];
  DDA_REFERENCE:nullable string[max=23];
  CCY_CODE:nullable string[max=3];
  CLAIMED_AMOUNT:nullable decimal[28,2];
  ORIGINATION_ACCOUNT:nullable string[max=60];
  PAYING_BANK:nullable string[max=15];
  PAYER_ACCOUNT:nullable string[max=50];
  APPLICATIONID:nullable string[max=30];
  DUMMY:nullable string[];
)
=+=+=+=
      END DSSUBRECORD
      MultiRow "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P9"
      OLEType "CTrxOutput"
      Readonly "0"
      Name "FILE"
      Partner "V213S0|V213S0P1"
      Reject "0"
      ErrorPin "0"
      RowLimit "0"
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "INSTRUCTION_CODE"
         SqlType "1"
         Precision "4"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.INSTRUCTION_CODE"
         Group "0"
         ParsedDerivation "DSLink3.INSTRUCTION_CODE"
         SourceColumn "DSLink3.INSTRUCTION_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OIC_CODE"
         SqlType "12"
         Precision "25"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.OIC_CODE"
         Group "0"
         ParsedDerivation "DSLink3.OIC_CODE"
         SourceColumn "DSLink3.OIC_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DDA_REFERENCE"
         SqlType "12"
         Precision "23"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.DDA_REFERENCE"
         Group "0"
         ParsedDerivation "DSLink3.DDA_REFERENCE"
         SourceColumn "DSLink3.DDA_REFERENCE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CCY_CODE"
         SqlType "12"
         Precision "3"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.CCY_CODE"
         Group "0"
         ParsedDerivation "DSLink3.CCY_CODE"
         SourceColumn "DSLink3.CCY_CODE"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CLAIMED_AMOUNT"
         SqlType "12"
         Precision "28"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "Field(VarAmount,'.',1) :'.':Left(Field(VarAmount,'.',2) :'00',2)"
         Group "0"
         ParsedDerivation "Field(VarAmount, '.', 1) : '.' : Left(Field(VarAmount, '.', 2) : '00', 2)"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         StageVars "VarAmount"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ORIGINATION_ACCOUNT"
         SqlType "12"
         Precision "60"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.ORIGINATION_ACCOUNT"
         Group "0"
         ParsedDerivation "DSLink3.ORIGINATION_ACCOUNT"
         SourceColumn "DSLink3.ORIGINATION_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYING_BANK"
         SqlType "12"
         Precision "15"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.PAYING_BANK"
         Group "0"
         ParsedDerivation "DSLink3.PAYING_BANK"
         SourceColumn "DSLink3.PAYING_BANK"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYER_ACCOUNT"
         SqlType "12"
         Precision "50"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.PAYER_ACCOUNT"
         Group "0"
         ParsedDerivation "DSLink3.PAYER_ACCOUNT"
         SourceColumn "DSLink3.PAYER_ACCOUNT"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "APPLICATIONID"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.APPLICATIONID"
         Group "0"
         ParsedDerivation "DSLink3.APPLICATIONID"
         SourceColumn "DSLink3.APPLICATIONID"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DUMMY"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Derivation "DSLink3.DUMMY"
         Group "0"
         ParsedDerivation "DSLink3.DUMMY"
         SourceColumn "DSLink3.DUMMY"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "Schema"
         Value =+=+=+=
record
(
  INSTRUCTION_CODE:nullable string[4];
  OIC_CODE:nullable string[max=25];
  DDA_REFERENCE:nullable string[max=23];
  CCY_CODE:nullable string[max=3];
  CLAIMED_AMOUNT:nullable string[max=28];
  ORIGINATION_ACCOUNT:nullable string[max=60];
  PAYING_BANK:nullable string[max=15];
  PAYER_ACCOUNT:nullable string[max=50];
  APPLICATIONID:nullable string[max=30];
  DUMMY:nullable string[];
)
=+=+=+=
      END DSSUBRECORD
      LeftTextPos "684"
      TopTextPos "447"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V211S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "DDA_TAMWEEL_AUDIT"
      NextID "3"
      InputPins "V211S0P2"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_SID#]]></Server><Username modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_USERNAME#]]></Username><Password modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_PASSWORD#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_SCHEMA#.DDA_TAMWEEL_AUDIT_TBL]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction collapsed='1' modified='1' type='int'><![CDATA[0]]></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount modified='1' type='int'><![CDATA[20000]]></RecordCount></Transaction><Session><ArraySize modified='1' type='int'><![CDATA[20000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging collapsed='1'><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V211S0P2"
      OLEType "CCustomInput"
      Readonly "0"
      Name "FILE_BKP"
      Partner "V0S2|V0S2P2"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V212S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "DDA_Takaful"
      NextID "2"
      OutputPins "V212S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_SID#]]></Server><Username modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_USERNAME#]]></Username><Password modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_PASSWORD#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified='1' type='string'><![CDATA[SELECT DD.CONTRACT_REF_NO ,'AUTH' AS Instruction_code,Substr(dd.DDA_REF_NO,1,9) AS OIC_Code ,dd.DDA_REF_NO AS dda_reference,C.CURRENCY_CODE AS ccy_code, 
CASE WHEN Dr.MAXIMUM_AMOUNT >= Dr.MINIMUM_AMOUNT THEN Dr.MAXIMUM_AMOUNT 
ELSE Dr.MINIMUM_AMOUNT END AS  claimed_amount 
, CASE WHEN C.CONTRACT_NO LIKE '996%' THEN 'AE350240001520893224701' 
       WHEN C.CONTRACT_NO LIKE '994%' THEN 'AE110240001520148996707' ELSE a.IBAN_ACCOUNT_NO END AS origination_account,
RO.ROUTINGNO AS Paying_Bank,IBAN_NO AS payer_account,REF_NO AS Applicationid,' ' AS DUMMY,dr.PRESENTATION_DATE , dd.FREQUENCY, DD.IBAN_NO ,C.PAYIN_ACCOUNT_NO ,C.PAYOUT_ACCOUNT_NO  ,Dr.MINIMUM_AMOUNT ,Dr.MAXIMUM_AMOUNT
FROM DDA_REGISTRATION_DETAILS DR 
LEFT OUTER JOIN DDA_DETAIL dd  ON DR.DDA_REF_NO =DD.DDA_REF_NO 
LEFT OUTER JOIN CONTRACT   C ON DD.CONTRACT_REF_NO =CASE WHEN DD.CONTRACT_REF_NO  LIKE 'MF%' THEN C.USER_REF_CODE ELSE C.CONTRACT_NO END  
LEFT OUTER JOIN  TEST_ODS.S4006_056_ROUTINGCODE RO ON RO.BANKNUM =SUBSTR(dd.BEN_BNK_DTLS,1,3)
LEFT OUTER JOIN  TEST_ODS.ACCOUNT a  ON NVL(C.PAYIN_ACCOUNT_2,C.PAYIN_ACCOUNT_NO) =a.ACCOUNT_NO  AND c.LEAD_COMPANY =a.LEAD_COMPANY 
WHERE DR.PURPOSE ='Takaful'
AND TO_CHAR( DATE '#BUSINESS_DATE#','MMDD') = TO_CHAR(DR.PRESENTATION_DATE, 'MMDD')
AND DR.DDS_STATUS ='Active'
AND C.CONTRACT_STATUS IN ('CURRENT')
AND DD.RECID NOT LIKE '%I']]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[DDA_REGISTRATION_DETAILS]]></Table><Table type='string'><![CDATA[DDA_DETAIL]]></Table><Table type='string'><![CDATA[CONTRACT]]></Table><Table type='string'><![CDATA[TEST_ODS.S4006_056_ROUTINGCODE]]></Table><Table type='string'><![CDATA[TEST_ODS.ACCOUNT]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[MAXIMUM_AMOUNT,MAXIMUM_AMOUNT,Dr]]></Column><Column type='string'><![CDATA[MINIMUM_AMOUNT,MINIMUM_AMOUNT,Dr]]></Column><Column type='string'><![CDATA[PAYOUT_ACCOUNT_NO,PAYOUT_ACCOUNT_NO,CONTRACT]]></Column><Column type='string'><![CDATA[PAYIN_ACCOUNT_NO,PAYIN_ACCOUNT_NO,CONTRACT]]></Column><Column type='string'><![CDATA[IBAN_NO,IBAN_NO,DD]]></Column><Column type='string'><![CDATA[FREQUENCY,FREQUENCY,DDA_DETAIL]]></Column><Column type='string'><![CDATA[PRESENTATION_DATE,PRESENTATION_DATE,dr]]></Column><Column type='string'><![CDATA[DUMMY,(null),DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[Applicationid,REF_NO,DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[payer_account,IBAN_NO,DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[Paying_Bank,ROUTINGNO,TEST_ODS.S4006_056_ROUTINGCODE]]></Column><Column type='string'><![CDATA[origination_account,(null),DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[claimed_amount,(null),DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[ccy_code,CURRENCY_CODE,CONTRACT]]></Column><Column type='string'><![CDATA[dda_reference,DDA_REF_NO,DDA_DETAIL]]></Column><Column type='string'><![CDATA[OIC_Code,DDA_REF_NO,DDA_DETAIL]]></Column><Column type='string'><![CDATA[Instruction_code,(null),DDA_REGISTRATION_DETAILS]]></Column><Column type='string'><![CDATA[CONTRACT_REF_NO,CONTRACT_REF_NO,DD]]></Column></Columns><WhereClause type='string'><![CDATA[(DR.PURPOSE = 'Takaful' AND TO_CHAR(DATE '#BUSINESS_DATE#', 'MMDD') = TO_CHAR(DR.PRESENTATION_DATE, 'MMDD') AND DR.DDS_STATUS = 'Active' AND C.CONTRACT_STATUS IN  ('CURRENT') AND DD.RECID NOT LIKE '%I')]]></WhereClause></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V212S0P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink3_takaful"
      Partner "V0S16|V0S16P4"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "CONTRACT_REF_NO"
         SqlType "12"
         Precision "16"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "INSTRUCTION_CODE"
         SqlType "1"
         Precision "4"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OIC_CODE"
         SqlType "12"
         Precision "25"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DDA_REFERENCE"
         SqlType "12"
         Precision "23"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CCY_CODE"
         SqlType "12"
         Precision "3"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CLAIMED_AMOUNT"
         SqlType "3"
         Precision "28"
         Scale "2"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ORIGINATION_ACCOUNT"
         SqlType "12"
         Precision "60"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYING_BANK"
         SqlType "12"
         Precision "15"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYER_ACCOUNT"
         SqlType "12"
         Precision "50"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "APPLICATIONID"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DUMMY"
         SqlType "12"
         Precision "1"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PRESENTATION_DATE"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FREQUENCY"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "IBAN_NO"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYIN_ACCOUNT_NO"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYOUT_ACCOUNT_NO"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "MINIMUM_AMOUNT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "MAXIMUM_AMOUNT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "165"
      TopTextPos "467"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V213S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "DDS_FILE"
      NextID "2"
      InputPins "V213S0P1"
      StageType "PxSequentialFile"
      AllowColumnMapping "0"
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V213S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "FILE"
      Partner "V0S2|V0S2P9"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "schema"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "file"
         Value "\(2)\(2)0\(1)\(3)file\(2)/reports/datamgmt/landing/DDS/DD500_TAMWEEL_#BUSINESS_DATE#_01.txt\(2)0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "append\\overwrite"
         Value "overwrite"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nocleanup"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "rejects"
         Value "continue"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "firstLineColumnNames"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "writemethod"
         Value "\(2)\(2)0\(1)\(3)writemethod\(2) \(2)0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
         Value "final_delim=end, delim=',', null_field=''"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V70S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "DDA_TAWEEL"
      NextID "3"
      OutputPins "V70S0P2"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_SID#]]></Server><Username modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_USERNAME#]]></Username><Password modified='1' type='string'><![CDATA[#TEST_Param.$TESTODS_PASSWORD#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[WITH cte AS 
(
SELECT c.CONTRACT_NO, c.BRANCH_CODE ,dd2.CONTRACT_REF_NO, dd2.DDA_REF_NO, dd2.DDA_STATUS, dd2.LEAD_COMPANY, dd2.FREQUENCY, c.USER_REF_CODE, REF_NO, PAYIN_ACCOUNT_NO, CURRENCY_CODE, PRODUCT_CODE
FROM DDA_DETAIL dd2 
INNER JOIN CONTRACT c  ON DD2.CONTRACT_REF_NO = CASE  WHEN DD2.CONTRACT_REF_NO  LIKE 'MF%' THEN C.USER_REF_CODE ELSE C.CONTRACT_NO END
WHERE  TEST_ODS.realapp(C.USER_REF_CODE) =TEST_ODS.realapp(dd2.REF_NO) AND dd2.DDA_STATUS  ='ACTIVE' AND C.LEAD_COMPANY =dd2.LEAD_COMPANY  AND dd2.FREQUENCY ='M'
AND C.CONTRACT_STATUS ='CURRENT'
AND Substr(C.BRANCH_CODE,-3) IN ('994','996','997') AND C.PRODUCT_CODE IN ('DPRI', 'DPRT', 'DRRI', 'DRRT', 'ETAP', 'HF46', 'HF47', 'HF49', 'HF50', 'HF51', 'HF52', 
'HF53', 'HF54', 'HF57', 'LICC', 'MB41', 'MB43', 'NB21', 'NB22', 'NB23', 'NB24', 'NB25', 'NB26', 'NB27', 'PAFE', 
'PARC', 'PCCA', 'PCES', 'PDCA', 'PDCC', 'PDCH', 'PDCM', 'PDLF', 'PDLO', 'PDMF', 'PDOD', 'PDSI', 'PDSN', 'PESC', 
'PEVF', 'PISO', 'PLDC', 'PLDF', 'PLDN', 'PLLC', 'PLLF', 'PLLT', 'PMGF', 'PMSC', 'PPFC', 'PPFF', 'PPIC', 'PPIF', 
'PPIN', 'PPIS', 'PRNT', 'PRSC', 'PRSF', 'PSAM', 'PSDT', 'PSEC', 'PSEN', 'SPIC', 'SPIF', 'SPIN', 'SPIS', 'SPIT', 
'TW01', 'TW02', 'TW03', 'TW04', 'TW05', 'TW06', 'TW07', 'TW08', 'TW09')
UNION 
SELECT c.CONTRACT_NO, c.BRANCH_CODE ,dd3.CONTRACT_REF_NO, dd3.DDA_REF_NO, dd3.DDA_STATUS, dd3.LEAD_COMPANY, dd3.FREQUENCY, c.USER_REF_CODE, REF_NO, PAYIN_ACCOUNT_NO, CURRENCY_CODE, PRODUCT_CODE 
FROM DDA_DETAIL dd3 
INNER JOIN CONTRACT c  ON CASE WHEN C.USER_REF_CODE LIKE 'MF%C%' THEN DD3.REF_NO ELSE DD3.CONTRACT_REF_NO END = CASE WHEN DD3.CONTRACT_REF_NO  LIKE 'MF%' THEN REPLACE(REGEXP_SUBSTR( REGEXP_SUBSTR(USER_REF_CODE, '[^-]+',  1,  1), '[^_]+',  1,  1),'CNV','') 
WHEN DD3.CONTRACT_REF_NO NOT LIKE 'MF%' THEN REPLACE(REGEXP_SUBSTR( REGEXP_SUBSTR(USER_REF_CODE, '[^-]+',  1,  1), '[^_]+',  1,  1),'CNV','') 
ELSE C.CONTRACT_NO END
WHERE  TEST_ODS.realapp(C.USER_REF_CODE) =TEST_ODS.realapp(dd3.REF_NO) AND dd3.DDA_STATUS  ='ACTIVE' AND C.LEAD_COMPANY =dd3.LEAD_COMPANY  AND dd3.FREQUENCY ='M'
AND C.CONTRACT_STATUS ='CURRENT'
AND Substr(C.BRANCH_CODE,-3) IN ('994','996','997') AND C.PRODUCT_CODE IN ('DPRI', 'DPRT', 'DRRI', 'DRRT', 'ETAP', 'HF46', 'HF47', 'HF49', 'HF50', 'HF51', 'HF52', 
'HF53', 'HF54', 'HF57', 'LICC', 'MB41', 'MB43', 'NB21', 'NB22', 'NB23', 'NB24', 'NB25', 'NB26', 'NB27', 'PAFE', 
'PARC', 'PCCA', 'PCES', 'PDCA', 'PDCC', 'PDCH', 'PDCM', 'PDLF', 'PDLO', 'PDMF', 'PDOD', 'PDSI', 'PDSN', 'PESC', 
'PEVF', 'PISO', 'PLDC', 'PLDF', 'PLDN', 'PLLC', 'PLLF', 'PLLT', 'PMGF', 'PMSC', 'PPFC', 'PPFF', 'PPIC', 'PPIF', 
'PPIN', 'PPIS', 'PRNT', 'PRSC', 'PRSF', 'PSAM', 'PSDT', 'PSEC', 'PSEN', 'SPIC', 'SPIF', 'SPIN', 'SPIS', 'SPIT', 
'TW01', 'TW02', 'TW03', 'TW04', 'TW05', 'TW06', 'TW07', 'TW08', 'TW09')
),
DDATABLE AS(
SELECT c.CONTRACT_NO,  'AUTH' AS Instruction_code,Substr(dd.DDA_REF_NO,1,9) AS OIC_Code ,dd.DDA_REF_NO AS dda_reference ,
C.CURRENCY_CODE AS ccy_code,--NVL(BAL.SETTLEMENT_AMT ,0),
CASE WHEN NVL(TO_NUMBER( DD.MIN_AMT),0) > NVL(BAL.SETTLEMENT_AMT ,0)  AND NVL(TO_NUMBER( DD.MIN_AMT),0)<>0 THEN CAST(TO_NUMBER( DD.MIN_AMT)AS DEcimal(28,2))
       WHEN NVL(TO_NUMBER( DD.MAX_AMT),0) < NVL(BAL.SETTLEMENT_AMT ,0) AND  NVL(TO_NUMBER( DD.MAX_AMT),0) <>0 THEN CAST(TO_NUMBER( DD.MAX_AMT)AS DEcimal(28,2))
ELSE CAST(NVL(BAL.SETTLEMENT_AMT ,0) AS DEcimal(28,2)) END  claimed_amount
, CASE WHEN C.CONTRACT_NO LIKE '996%' THEN 'AE350240001520893224701' 
       WHEN C.CONTRACT_NO LIKE '994%' THEN 'AE110240001520148996707' ELSE a.IBAN_ACCOUNT_NO END AS origination_account --a.ACC_NO
,RO.ROUTINGNO AS Paying_Bank ,IBAN_NO AS payer_account,dd.REF_NO AS Applicationid,' ' AS DUMMY, MAX(CAA_BALANCE) CA_BALANCE, MAX(CURRENT_DUE_AMOUNT) CURRENT_DUE_AMOUNT, 
MAX(CURRENT_PAID_AMOUNT) CURRENT_PAID_AMOUNT, --MAX(CHQ_AMOUNT) CHQ_AMOUNT, 
MAX(DD.MIN_AMT) MIN_AMT, MAX(DD.MAX_AMT) MAX_AMT, MAX(FUTURE_EMI_CNT) FUTURE_EMI_CNT, MAX(CURRENT_DUE_DATE) CURRENT_DUE_DATE
FROM  cte C 
LEFT OUTER JOIN  TEST_ODS.DDA_DETAIL dd ON DD.REF_NO =C.REF_NO AND realapp(C.USER_REF_CODE) =TEST_ODS.realapp(dd.REF_NO) AND dd.DDA_STATUS  ='ACTIVE' AND C.LEAD_COMPANY =dd.LEAD_COMPANY  AND dd.FREQUENCY ='M'
LEFT OUTER JOIN  TEST_ODS.DDA_REGISTRATION_DETAILS DR ON DR.DDA_REF_NO = DD.DDA_REF_NO AND DR.DDS_STATUS = 'Active'  AND DR.PURPOSE <> 'Takaful'
LEFT OUTER JOIN  TEST_ODS.ACCOUNT a  ON CASE WHEN DD.CONTRACT_REF_NO  LIKE 'MF%' THEN C.PAYIN_ACCOUNT_NO ELSE dd.ACC_NO END  =a.ACCOUNT_NO  AND  c.LEAD_COMPANY=a.LEAD_COMPANY 
LEFT OUTER JOIN  TEST_ODS.S4006_056_ROUTINGCODE RO ON RO.BANKNUM =SUBSTR(dd.BEN_BNK_DTLS,1,3)
INNER JOIN (
              SELECT C.CONTRACT_NO,C.PAYIN_ACCOUNT_NO AS SETTLEMENT_ACCOUNT , MAX(FUTURE_EMI_CNT) FUTURE_EMI_CNT, MAX(NVL(CURRENT_DUE_AMOUNT, 0)) CURRENT_DUE_AMOUNT
              , MAX(NVL(CURRENT_PAID_AMOUNT, 0)) CURRENT_PAID_AMOUNT,
max(NVL(ab.LCY_CURRENT_BAL_AMT,0)+NVL(EMI.CURRENT_PAID_AMOUNT,0)) AS CA_BALANCE,
MAX(NVL(ab.LCY_CURRENT_BAL_AMT,0)) CAA_BALANCE,
MAX(CASE WHEN NVL(FUTURE_EMI_CNT, 0) = 0 THEN
          NVL(CURRENT_DUE_AMOUNT-CURRENT_PAY_AMOUNT, 0) - ( NVL(CURRENT_PAID_AMOUNT, 0) + NVL (AB.LCY_CURRENT_BAL_AMT,0)  ) -- RECOVERY AMOUNT FOR FINAL INSTALLMENT
          ELSE 
      NVL(CURRENT_DUE_AMOUNT-CURRENT_PAY_AMOUNT, 0) - NVL(CURRENT_PAID_AMOUNT, 0)  - (NVL(AB.LCY_CURRENT_BAL_AMT, 0) / NVL(FUTURE_EMI_CNT, 0))
      END) AS SETTLEMENT_AMT,
   MAX(CURRENT_DUE_DATE) CURRENT_DUE_DATE
              FROM 
              cte c  
              LEFT OUTER JOIN TEST_ODS.ACCOUNT_BALANCE ab  ON C.PAYIN_ACCOUNT_NO=ab.ACCOUNT_NO and  to_char(ab.REPORTING_DATE,'YYYY-MM-DD')= to_CHAR(DATE '#BUSINESS_DATE#' -1  ,'YYYY-MM-DD') 
              INNER  JOIN 
(                    
SELECT A.CONTRACT_CODE,  NVL(COUNT(DISTINCT CASE WHEN COMPONENT = 'ACCOUNT' AND NVL(DUE_AMT_LCY, 0) <> 0 AND TO_CHAR(DUE_DATE, 'YYYY-MM-DD') > '#BUSINESS_DATE#' THEN DUE_DATE END ), 0) FUTURE_EMI_CNT,
SUM(CASE WHEN TO_CHAR(DUE_DATE, 'YYYY-MM') = To_char( DATE '#BUSINESS_DATE#','YYYY-MM') AND DUE_METHOD='DUE'  THEN NVL(DUE_AMT_LCY, 0)  ELSE 0 END) CURRENT_DUE_AMOUNT,
SUM(CASE WHEN TO_CHAR(DUE_DATE, 'YYYY-MM') = To_char( DATE '#BUSINESS_DATE#','YYYY-MM') AND DUE_METHOD='PAY'  THEN NVL(DUE_AMT_LCY, 0)  ELSE 0 END) CURRENT_PAY_AMOUNT,
SUM(CASE WHEN TO_CHAR(DUE_DATE, 'YYYY-MM') = To_char( DATE '#BUSINESS_DATE#','YYYY-MM') AND DUE_METHOD='DUE'  THEN NVL(PAID_AMT_LCY, 0)  ELSE 0 END) CURRENT_PAID_AMOUNT,
SUM(CASE WHEN TO_CHAR(DUE_DATE, 'YYYY-MM-DD') = '#BUSINESS_DATE#' AND COMPONENT = 'TAKAFULCHG' THEN NVL(DUE_AMT_LCY, 0)  ELSE 0 END) TKF_CHG_DUE,
MAX(CASE WHEN TO_CHAR(DUE_DATE, 'YYYY-MM') = To_char( DATE '#BUSINESS_DATE#','YYYY-MM')  THEN DUE_DATE END) CURRENT_DUE_DATE
FROM TEST_ODS.CONTRACT_PAYMENT_SCHEDULE A
INNER JOIN 
cte C 
ON A.CONTRACT_CODE = C.CONTRACT_NO   
AND COMPONENT NOT IN ('DOWNPMNT') 
AND TO_CHAR(DUE_DATE, 'YYYY-MM') >= To_char( DATE '#BUSINESS_DATE#','YYYY-MM')
INNER JOIN 
TEST_ODS.DDA_DETAIL dd ON DD.REF_NO =C.REF_NO
AND TEST_ODS.realapp(C.USER_REF_CODE) =TEST_ODS.realapp(dd.REF_NO) AND dd.DDA_STATUS  ='ACTIVE' AND C.LEAD_COMPANY =dd.LEAD_COMPANY  AND dd.FREQUENCY ='M'
LEFT OUTER JOIN 
TEST_ODS.DDA_REGISTRATION_DETAILS DR ON DR.DDA_REF_NO = DD.DDA_REF_NO AND DR.DDS_STATUS = 'Active'  AND DR.PURPOSE <> 'Takaful'
WHERE  
CASE WHEN Substr(C.BRANCH_CODE,-3) ='996' AND DR.PRESENTATION_DATE IS NULL AND TO_CHAR(DUE_DATE, 'YYYY-MM-DD') = '#BUSINESS_DATE#' THEN 1 
		WHEN Substr(C.BRANCH_CODE,-3) IN ('997','994') AND TO_CHAR(DUE_DATE, 'YYYY-MM-DD') = '#BUSINESS_DATE#' THEN 1
          WHEN LAST_DAY(DR.PRESENTATION_DATE) = DR.PRESENTATION_DATE 
               AND  LAST_DAY(DATE '#BUSINESS_DATE#' ) =  DATE '#BUSINESS_DATE#' AND LAST_DAY(DR.PRESENTATION_DATE)= DATE '#BUSINESS_DATE#' THEN 1              
          WHEN Substr(C.BRANCH_CODE,-3) ='996' AND TO_CHAR( DATE '#BUSINESS_DATE#','DD') = TO_CHAR(DR.PRESENTATION_DATE, 'DD') THEN 1  
          ELSE 0 END = 1
/*adding by RtB ,dd.DDA_REF_NO to avoid the double deduction*/          
GROUP BY A.CONTRACT_CODE,dd.DDA_REF_NO
                           ) EMI
                           ON EMI.CONTRACT_CODE=C.CONTRACT_NO 
              GROUP BY C.CONTRACT_NO,C.PAYIN_ACCOUNT_NO
       ) BAL ON BAL.CONTRACT_NO=C.CONTRACT_NO
WHERE DD.RECID NOT LIKE '%I'
GROUP  BY  dd.DDA_REF_NO,RO.ROUTINGNO,a.IBAN_ACCOUNT_NO,dd.REF_NO,C.CURRENCY_CODE,IBAN_NO,BAL.SETTLEMENT_AMT,
ACC_NO, c.CONTRACT_NO, DD.MIN_AMT, DD.MAX_AMT )  
SELECT * FROM DDATABLE WHERE claimed_amount <>0  and  CAST(claimed_amount AS decimal(28,2)) >0 
AND CURRENT_DUE_AMOUNT <> 0--AND ORIGINATION_ACCOUNT  IS NOT NULL]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V70S0P2"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink3_taweel"
      Partner "V0S16|V0S16P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "CONTRACT_NO"
         SqlType "12"
         Precision "16"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "INSTRUCTION_CODE"
         SqlType "1"
         Precision "4"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OIC_CODE"
         SqlType "12"
         Precision "25"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DDA_REFERENCE"
         SqlType "12"
         Precision "23"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CCY_CODE"
         SqlType "12"
         Precision "3"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CLAIMED_AMOUNT"
         SqlType "3"
         Precision "28"
         Scale "2"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ORIGINATION_ACCOUNT"
         SqlType "12"
         Precision "60"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYING_BANK"
         SqlType "12"
         Precision "15"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "PAYER_ACCOUNT"
         SqlType "12"
         Precision "50"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "APPLICATIONID"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DUMMY"
         SqlType "12"
         Precision "1"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CA_BALANCE"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CURRENT_DUE_AMOUNT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CURRENT_PAID_AMOUNT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "MIN_AMT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "MAX_AMT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FUTURE_EMI_CNT"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CURRENT_DUE_DATE"
         SqlType "12"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "150"
      TopTextPos "343"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
